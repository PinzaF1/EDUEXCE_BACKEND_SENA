# ============================================
# CONFIGURACIÓN DE PRODUCCIÓN - EDUEXCE BACKEND
# ============================================
# Copia este archivo como .env.production y ajusta los valores

# ==================== APLICACIÓN ====================
NODE_ENV=production
PORT=3333
HOST=0.0.0.0

# Clave secreta de la aplicación (genera una única con: node ace generate:key)
APP_KEY=oX6-X96FTJHunx3nupxa0n-BJdufzSS1

# ==================== BASE DE DATOS (SUPABASE) ====================
# ⚠️ IMPORTANTE: Usar Session Pooler (IPv4 compatible)
# NO usar Direct Connection (requiere IPv6)
DB_HOST=aws-1-us-east-2.pooler.supabase.com
DB_PORT=5432
DB_USER=postgres.qjqhdfhiedsqrstymbio
DB_PASSWORD=Sena12345Zavira
DB_DATABASE=postgres

# ==================== JWT (AUTENTICACIÓN) ====================
# Clave secreta para tokens JWT
JWT_SECRET=secret123
# Duración del token de sesión (en segundos) - 86400 = 24 horas
JWT_EXPIRES_IN=86400
# Duración del token de recuperación (en segundos) - 900 = 15 minutos
JWT_RECOVERY_EXPIRES=900

# ==================== REDIS (CACHÉ) ====================
# URL de conexión a Redis (en Docker Compose usa el nombre del servicio)
REDIS_URL=redis://redis:6379

# ==================== SMTP (ENVÍO DE EMAILS - BREVO) ====================
# Configuración de Brevo para envío de emails reales
# Dashboard: https://app.brevo.com/

SMTP_HOST=smtp-relay.brevo.com
SMTP_PORT=587

# Usuario: El login que aparece en tu dashboard de Brevo
# (Settings → SMTP & API → "Iniciar sesión")
SMTP_USER=TU_LOGIN_BREVO_AQUI@smtp-brevo.com

# Password: La SMTP Key generada en Brevo
# (Settings → SMTP & API → "Generar una nueva clave SMTP")
SMTP_PASS=xsmtpsib-TU_CLAVE_SMTP_DE_BREVO_AQUI

# Remitente: DEBE ser un email verificado en Brevo
# Opción 1: Tu email de registro de Brevo (más fácil)
SMTP_FROM=tu-email-de-registro-brevo@gmail.com
# Opción 2: Un email personalizado verificado (requiere verificar dominio)
# SMTP_FROM=noreply@eduexce.com

# ==================== FRONTEND ====================
# URL del frontend (para links en emails y CORS)
# Desarrollo: http://localhost:5173
# Producción con ngrok: https://tu-dominio.ngrok-free.dev
# Producción real: https://tu-frontend-produccion.com
FRONT_URL=https://gillian-semiluminous-blubberingly.ngrok-free.dev

# ==================== FIREBASE ADMIN SDK (NOTIFICACIONES FCM) ====================
# Credenciales de Firebase Admin SDK para enviar notificaciones push a Android
# 
# ⚠️ MÉTODO 1: JSON Escapado (RECOMENDADO para Docker/Producción)
# Obtén el JSON de tu Firebase Console → Project Settings → Service Accounts → Generate new private key
# Copia TODO el contenido del JSON en UNA sola línea (sin saltos de línea)
# Ejemplo: FIREBASE_SERVICE_ACCOUNT={"type":"service_account","project_id":"tu-proyecto",...}
FIREBASE_SERVICE_ACCOUNT=
#
# ⚠️ MÉTODO 2: Archivo externo (alternativa)
# Si prefieres usar archivo, crea: config/firebase-admin-sdk.json
# El sistema detectará automáticamente cuál método usar

# ==================== OPENAI (GENERACIÓN DE PREGUNTAS CON IA) ====================
# API Key de OpenAI para generar preguntas dinámicas personalizadas
# Dashboard: https://platform.openai.com/
# Obtener API key: https://platform.openai.com/api-keys

# ⚠️ IMPORTANTE: Esta key permite generar preguntas con IA
# Sin ella, el sistema usa el banco de preguntas local como fallback
OPENAI_API_KEY=sk-proj-TU_API_KEY_DE_OPENAI_AQUI

# Modelo a usar (gpt-4o-mini = $0.150 / 1M tokens input, $0.600 / 1M tokens output)
# Alternativas: gpt-4o, gpt-4-turbo, gpt-3.5-turbo
OPENAI_MODEL=gpt-4o-mini

# Timeout en milisegundos (20000 = 20 segundos)
# Balance entre esperar respuesta vs timeout rápido
OPENAI_TIMEOUT_MS=20000

# Base URL (opcional, solo si usas proxy o Azure OpenAI)
# OPENAI_BASE_URL=https://api.openai.com/v1

# Feature Flag: Usar IA directa o fallback a banco local
# true = Usa OpenAI SDK directo (RECOMENDADO)
# false = Usa banco local de preguntas
USE_OPENAI_DIRECT=true

# ============================================
# NOTAS IMPORTANTES:
# ============================================
#
# 1. NUNCA subas este archivo con valores reales a Git
# 2. En producción, cambia JWT_SECRET por una clave única y segura
# 3. Para generar APP_KEY: node ace generate:key
# 4. Brevo plan gratuito: 300 emails/día
# 5. SMTP_FROM debe ser el email con el que te registraste en Brevo
#    o un email/dominio verificado en tu cuenta de Brevo
# 6. OpenAI gpt-4o-mini: ~$0.15 por millón de tokens de entrada
#                        ~$0.60 por millón de tokens de salida
#
# ============================================

